# Nosova-embedika-test

## Подготовка к работе
1) установите зависимости

pip3 install -r requirements.txt

2) Скачайте веса модели. Это можно сделать командой
python3 download_model.py. Когда скачивание завершится, в консоли появится лог done.
Если при автоматическом скачивании возникают проблемы, 
вы можете вручную скачать файл с весами из общедоступной гугл-папки
https://drive.google.com/drive/folders/1HqQ9dFklQyikYUuJb8RSSVHisOKEvOGr?usp=sharing
Веса модели нужно положить в папку models/kremlin_gpt

## Запуск парсера (необязательно выполнять для генерации)
Парсер запускается командой
bash parsing.sh

Если вы хотите пронаблюдать все этапы работы парсера, 
перед запуском  удалите выходной файл data/kremlin_ner_dataset.csv

## Демонстрация генерации
Для запуска демонстрации выполните команду

python3 -m web_demo --port [PORT]

[PORT] -  порт, на котором вы хотите развернуть демонстрацию.
По умолчанию используется порт 8050.

Пока ждете результатов генерации, не нажимайте на кнопку снова. 
Персону желательно вводить с именем или инициалами.

После того, как вы ознакомитесь с демонстрацией, нужно любым способом
(например, lsof -i tcp:[PORT]) узнать pid процесса и остановить его командой
kill -9 [PROCESS_ID]

## Тетрадки

train_generation.ipynb - файнтюн модели (на колабе, имитировать пути к файлам проекта не стала), выбор количества эпох и  наблюдения про принцип формирования затравки

generation_parameters.ipynb - анализ параметров генерации
Лучшие метрики показала жадная генерация, но в демо используется nucleus sampling, чтобы генерировать несколько текстов в батче и выбирать тот, где будут повторяться сущности
